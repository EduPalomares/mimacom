(this.webpackJsonpmimacom=this.webpackJsonpmimacom||[]).push([[0],{32:function(e,t,c){},34:function(e,t){var c;function s(){c=clearTimeout(c),c=setTimeout((function(){document.documentElement.style.setProperty("--vh","".concat(window.innerHeight/100,"px"))}),500)}window.addEventListener("resize",s),window.addEventListener("orientationchange",s),s()},35:function(e,t,c){"use strict";c.r(t);var s=c(0),a=(c(31),c(32),c(2)),n=c(10),r=c.n(n),i=c(13),o=c(5),d=c(1),u=c(3),b=c(14),j=c(8),l=c(9),O=c.p+"static/media/basket.c8405a74.svg",_=c(7),m=function(e){var t,c=e.id,a=e.image_url,n=e.productName,r=e.price,i=e.productDescription,o=e.favorite,d=Object(u.b)(),b=(null===(t=Object(u.c)((function(e){return e.products}))[c])||void 0===t?void 0:t.stock)||0;return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"product",children:[Object(s.jsx)("div",{className:"product__favorite ".concat(o?"active":"")}),Object(s.jsx)("div",{className:"product__img",style:{backgroundImage:"url("+encodeURI(a)+")"}}),Object(s.jsxs)("div",{className:"product__info",children:[Object(s.jsx)("div",{className:"product__name",children:n}),Object(s.jsx)("div",{className:"product__price",children:r}),Object(s.jsx)("div",{className:"product__description",children:i})]}),Object(s.jsxs)("div",{className:"product__actions",children:[Object(s.jsxs)("div",{className:"product__stock",children:[b," left"]}),Object(s.jsx)("button",{disabled:0===b,onClick:function(){return d(Object(_.a)(c))},children:"+ Add"})]})]})})},f=function(){var e=Object(u.b)(),t=Object(d.useState)([]),c=Object(o.a)(t,2),n=c[0],_=c[1],f=Object(d.useState)([]),p=Object(o.a)(f,2),k=p[0],v=p[1],h=Object(d.useState)(1),x=Object(o.a)(h,2),N=x[0],g=x[1],y=Object(u.c)((function(e){return e.basket})),w=Object(d.useState)(0),P=Object(o.a)(w,2),B=P[0],C=P[1],E=Object(d.useCallback)(Object(i.a)(r.a.mark((function t(){var c,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://my-json-server.typicode.com/EduPalomares/mimacom-server-api","/grocery?_page=").concat(N,"&_limit=12"));case 3:return c=t.sent,t.next=6,c.json();case 6:s=t.sent,_(s),e(Object(j.a)(s)),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])}))),[e,N]);return Object(d.useEffect)((function(){v(n.map((function(e,t){return Object(s.jsx)(m,Object(a.a)({},e),t)})))}),[n]),Object(d.useEffect)((function(){E()}),[N,E]),Object(d.useEffect)((function(){C(Object.entries(y).reduce((function(e,t){var c=Object(o.a)(t,2);c[0];return e+c[1].stock}),0))}),[y]),Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"products",children:[Object(s.jsxs)("div",{className:"products__header",children:[Object(s.jsx)("h1",{children:"Product List"}),Object(s.jsx)("div",{className:"products__actions",children:Object(s.jsxs)("div",{className:"products__action products__action__basket",children:[Object(s.jsx)("button",{onClick:function(){return e(Object(l.b)(!0))},children:Object(s.jsx)("img",{src:O,alt:""})}),Object(s.jsx)("div",{className:"products__actions__basket__amount",hidden:0===B,children:B})]})})]}),Object(s.jsx)(b.a,{className:"products__list__wrapper",children:Object(s.jsx)("div",{className:"products__list",children:k})}),Object(s.jsxs)("div",{className:"products__list__actions",children:[Object(s.jsx)("button",{className:"products__list__actions__previous",onClick:function(){g(N-1)},disabled:1===N,children:"Previous"}),Object(s.jsx)("button",{className:"products__list__actions__next",onClick:function(){g(N+1)},children:"Next"})]})]})})},p=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.basket})),c=Object(u.c)((function(e){return e.products})),n=Object(u.c)((function(e){return e.ui.visibleBasket})),j=Object(d.useState)(0),O=Object(o.a)(j,2),m=O[0],f=O[1],p=Object.entries(t).map((function(t){var c=Object(o.a)(t,2),a=(c[0],c[1]);return Object(s.jsxs)("div",{className:"basket__item",children:[Object(s.jsx)("div",{className:"basket__item__image",style:{backgroundImage:"url("+encodeURI(a.image_url)+")"}}),Object(s.jsxs)("div",{className:"basket__item__middle",children:[Object(s.jsx)("div",{className:"basket__item__name",children:a.productName}),Object(s.jsxs)("div",{className:"basket__item__amount",children:[Object(s.jsx)("button",{className:"basket__item__subtract",onClick:function(){return e(Object(_.d)(a.id))}}),a.stock,Object(s.jsx)("button",{className:"basket__item__add",onClick:function(){return e(Object(_.a)(a.id))}})]})]}),Object(s.jsx)("div",{className:"basket__item__price",children:a.price})]},a.id)})),k=function(){e(Object(l.b)(!n))};return Object(d.useEffect)((function(){f(Object.entries(t).reduce((function(e,t){var c=Object(o.a)(t,2),s=(c[0],c[1]);return e+s.stock*s.price}),0))}),[t]),Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"basket__wrapper ".concat(n?"visible":""),children:[Object(s.jsx)("div",{className:"basket__bg",onClick:k}),Object(s.jsxs)("div",{className:"basket",children:[Object(s.jsxs)("div",{className:"basket__header",onClick:k,children:[Object(s.jsx)("h1",{children:"Basket"}),Object(s.jsx)("button",{className:"basket__back"})]}),Object(s.jsx)(b.a,{className:"basket__items__wrapper",children:Object(s.jsx)("div",{className:"basket__items",children:p})}),Object(s.jsxs)("div",{className:"basket__resume",children:[Object(s.jsxs)("div",{className:"basket__total",children:[Object(s.jsx)("div",{className:"basket__total__text",children:"Total Amount"}),Object(s.jsx)("div",{className:"basket__total__price",children:m})]}),Object(s.jsx)("div",{className:"basket__actions",children:Object(s.jsx)("button",{disabled:0===m,onClick:function(){try{Object.entries(t).forEach(function(){var e=Object(i.a)(r.a.mark((function e(s){var n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(o.a)(s,2),n[0],i=n[1],e.next=3,fetch("http://localhost:3000/grocery/"+i.id,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(a.a)(Object(a.a)({},i),{},{stock:c[i.id].stock-t[i.id].stock}))});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(s){}e(Object(_.b)()),alert("Purchase Completed!!!")},children:"Make a payment"})})]})]})]})})},k=function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("main",{className:"mimacom",children:[Object(s.jsx)(f,{}),Object(s.jsx)(p,{})]})})};c(34);t.default=function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(k,{})})}},36:function(e,t,c){"use strict";c.r(t);var s=c(0),a=c(12),n=c.n(a),r=c(3),i=c(6),o=c(4),d=c(7),u=c(8),b=c(9),j=Object(o.c)({basket:d.c,products:u.b,ui:b.a});var l=Object(i.a)({reducer:j});!function(){var e=c(35).default;n.a.render(Object(s.jsx)(r.a,{store:l,children:Object(s.jsx)(e,{})}),document.getElementById("root"))}()},7:function(e,t,c){"use strict";c.d(t,"b",(function(){return d})),c.d(t,"a",(function(){return j})),c.d(t,"d",(function(){return l}));var s=c(2),a=c(6),n=c(8),r={},i=Object(a.b)({name:"basket",initialState:r,reducers:{clearBasket:function(){return r},setProductInBasket:function(e,t){var c=t.payload;e[c.id]=c},rmvProductFromBasket:function(e,t){delete e[t.payload]}}}),o=i.actions,d=o.clearBasket,u=o.setProductInBasket,b=o.rmvProductFromBasket;t.c=i.reducer;var j=function(e){return function(t,c){var a=c().basket,r=c().products,i=a[e];t(u(i?Object(s.a)(Object(s.a)({},i),{},{stock:i.stock+1}):Object(s.a)(Object(s.a)({},r[e]),{},{stock:1}))),t(Object(n.c)(Object(s.a)(Object(s.a)({},r[e]),{},{stock:r[e].stock-1})))}},l=function(e){return function(t,c){var a=c().basket,r=c().products,i=a[e];i&&(i.stock>1?t(u(Object(s.a)(Object(s.a)({},i),{},{stock:i.stock-1}))):t(b(e)),t(Object(n.c)(Object(s.a)(Object(s.a)({},r[e]),{},{stock:r[e].stock+1}))))}}},8:function(e,t,c){"use strict";c.d(t,"a",(function(){return r})),c.d(t,"c",(function(){return i}));var s=c(6),a=Object(s.b)({name:"products",initialState:{},reducers:{addProducts:function(e,t){t.payload.forEach((function(t){e[t.id]=t}))},setProduct:function(e,t){var c=t.payload;e[c.id]=c}}}),n=a.actions,r=n.addProducts,i=n.setProduct;t.b=a.reducer},9:function(e,t,c){"use strict";c.d(t,"b",(function(){return n}));var s=c(6),a=Object(s.b)({name:"ui",initialState:{visibleBasket:!1},reducers:{setVisibleBasket:function(e,t){var c=t.payload;e.visibleBasket=c}}}),n=a.actions.setVisibleBasket;t.a=a.reducer}},[[36,1,2]]]);
//# sourceMappingURL=main.91523cd3.chunk.js.map