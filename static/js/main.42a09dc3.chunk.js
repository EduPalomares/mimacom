(this.webpackJsonpmimacom=this.webpackJsonpmimacom||[]).push([[0],{17:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(9),a=c.n(n);!function(){var e=c(33).default;a.a.render(Object(s.jsx)(e,{}),document.getElementById("root"))}()},30:function(e,t,c){},32:function(e,t){var c;function s(){c=clearTimeout(c),c=setTimeout((function(){document.documentElement.style.setProperty("--vh","".concat(window.innerHeight/100,"px"))}),500)}window.addEventListener("resize",s),window.addEventListener("orientationchange",s),s()},33:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(3),a=c(6),r=c(4),i=c(2),o=Object(a.b)({name:"products",initialState:{},reducers:{addProducts:function(e,t){t.payload.forEach((function(t){e[t.id]=t}))},setProduct:function(e,t){var c=t.payload;e[c.id]=c}}}),d=o.actions,u=d.addProducts,b=d.setProduct,j=o.reducer,l={},O=Object(a.b)({name:"basket",initialState:l,reducers:{clearBasket:function(){return l},setProductInBasket:function(e,t){var c=t.payload;e[c.id]=c},rmvProductFromBasket:function(e,t){delete e[t.payload]}}}),_=O.actions,m=_.clearBasket,f=_.setProductInBasket,v=_.rmvProductFromBasket,h=O.reducer,p=function(e){return function(t,c){var s=c().basket,n=c().products,a=s[e];t(f(a?Object(i.a)(Object(i.a)({},a),{},{stock:a.stock+1}):Object(i.a)(Object(i.a)({},n[e]),{},{stock:1}))),t(b(Object(i.a)(Object(i.a)({},n[e]),{},{stock:n[e].stock-1})))}},k=Object(a.b)({name:"ui",initialState:{visibleBasket:!1},reducers:{setVisibleBasket:function(e,t){var c=t.payload;e.visibleBasket=c}}}),x=k.actions.setVisibleBasket,N=k.reducer,g=Object(r.c)({basket:h,products:j,ui:N});var w,y=Object(a.a)({reducer:g}),E=c(1),C=[],P=c.n(E).a.createContext(),B=function(){w=Object(E.useContext)(P);var e=Object(E.useCallback)((function(){document.onkeydown=function(e){var t,c=(e=e||window.event).key;e.altKey&&"Alt"!==c&&(c="Alt+"+c),e.ctrlKey&&"Control"!==c&&(c="Control+"+c),e.shiftKey&&"Shift"!==c&&(c="Shift+"+c),(null===(t=w)||void 0===t?void 0:t[c])&&(w[c].prevent&&(e.preventDefault(),e.stopPropagation()),function(e,t,c){t();var s=new CustomEvent(e,{detail:c.message});document.dispatchEvent(s)}(c,(function(){return w[c].f()}),{message:"New Event: "+c}))}}),[]);return Object(E.useEffect)((function(){e()}),[e]),{addKEvent:function(e,t){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w[e]={f:t,prevent:c}},removeKEvent:function(e){w[e]=null},setKeyboardEvents:e}},S=function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(P.Provider,{value:C,children:e.children})})},A=(c(29),c(30),c(7)),F=c.n(A),K=c(10),I=c(5),L=c(11),T=c.p+"static/media/basket.c8405a74.svg",R=function(e){var t,c=e.id,a=e.image_url,r=e.productName,i=e.price,o=e.productDescription,d=e.favorite,u=Object(n.b)(),b=(null===(t=Object(n.c)((function(e){return e.products}))[c])||void 0===t?void 0:t.stock)||0;return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"product",children:[Object(s.jsx)("div",{className:"product__favorite ".concat(d?"active":"")}),Object(s.jsx)("div",{className:"product__img",style:{backgroundImage:"url("+encodeURI(a)+")"}}),Object(s.jsxs)("div",{className:"product__info",children:[Object(s.jsx)("div",{className:"product__name",children:r}),Object(s.jsx)("div",{className:"product__price",children:i}),Object(s.jsx)("div",{className:"product__description",children:o})]}),Object(s.jsxs)("div",{className:"product__actions",children:[Object(s.jsxs)("div",{className:"product__stock",children:[b," left"]}),Object(s.jsx)("button",{disabled:0===b,onClick:function(){u(p(c))},children:"+ Add"})]})]})})},J=function(){var e=Object(n.b)(),t=B(),c=t.addKEvent,a=t.removeKEvent,r=Object(E.useState)([]),o=Object(I.a)(r,2),d=o[0],b=o[1],j=Object(E.useState)([]),l=Object(I.a)(j,2),O=l[0],_=l[1],m=Object(E.useState)(1),f=Object(I.a)(m,2),v=f[0],h=f[1],p=Object(n.c)((function(e){return e.basket})),k=Object(E.useState)(0),N=Object(I.a)(k,2),g=N[0],w=N[1],y=Object(E.useCallback)(Object(K.a)(F.a.mark((function t(){var c,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("http://localhost:3000","/grocery?_page=").concat(v,"&_limit=12"));case 3:return c=t.sent,t.next=6,c.json();case 6:s=t.sent,b(s),e(u(s)),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])}))),[e,v]);return Object(E.useEffect)((function(){_(d.map((function(e,t){return Object(s.jsx)(R,Object(i.a)({},e),t)})))}),[d]),Object(E.useEffect)((function(){y()}),[v,y]),Object(E.useEffect)((function(){w(Object.entries(p).reduce((function(e,t){var c=Object(I.a)(t,2);c[0];return e+c[1].stock}),0))}),[p]),Object(E.useEffect)((function(){if(window.innerWidth<1024)return c("ArrowLeft",(function(){e(x(!0))})),c("ArrowRight",(function(){e(x(!1))})),function(){a("ArrowLeft"),a("ArrowRight")}}),[c,a,e]),Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"products",children:[Object(s.jsxs)("div",{className:"products__header",children:[Object(s.jsx)("h1",{children:"Product List"}),Object(s.jsx)("div",{className:"products__actions",children:Object(s.jsxs)("div",{className:"products__action products__action__basket",children:[Object(s.jsx)("button",{onClick:function(){return e(x(!0))},children:Object(s.jsx)("img",{src:T,alt:""})}),Object(s.jsx)("div",{className:"products__actions__basket__amount",hidden:0===g,children:g})]})})]}),Object(s.jsx)(L.a,{className:"products__list__wrapper",children:Object(s.jsx)("div",{className:"products__list",children:O})}),Object(s.jsxs)("div",{className:"products__list__actions",children:[Object(s.jsx)("button",{className:"products__list__actions__previous",onClick:function(){h(v-1)},disabled:1===v,children:"Previous"}),Object(s.jsx)("button",{className:"products__list__actions__next",onClick:function(){h(v+1)},children:"Next"})]})]})})},D=function(){var e=Object(n.b)(),t=Object(n.c)((function(e){return e.basket})),c=Object(n.c)((function(e){return e.products})),a=Object(n.c)((function(e){return e.ui.visibleBasket})),r=Object(E.useState)(0),o=Object(I.a)(r,2),d=o[0],u=o[1],j=Object.entries(t).map((function(t){var c=Object(I.a)(t,2),n=(c[0],c[1]);return Object(s.jsxs)("div",{className:"basket__item",children:[Object(s.jsx)("div",{className:"basket__item__image",style:{backgroundImage:"url("+encodeURI(n.image_url)+")"}}),Object(s.jsxs)("div",{className:"basket__item__middle",children:[Object(s.jsx)("div",{className:"basket__item__name",children:n.productName}),Object(s.jsxs)("div",{className:"basket__item__amount",children:[Object(s.jsx)("button",{className:"basket__item__subtract",onClick:function(){return e((t=n.id,function(e,c){var s=c().basket,n=c().products,a=s[t];a&&(a.stock>1?e(f(Object(i.a)(Object(i.a)({},a),{},{stock:a.stock-1}))):e(v(t)),e(b(Object(i.a)(Object(i.a)({},n[t]),{},{stock:n[t].stock+1}))))}));var t}}),n.stock,Object(s.jsx)("button",{className:"basket__item__add",onClick:function(){return e(p(n.id))}})]})]}),Object(s.jsx)("div",{className:"basket__item__price",children:n.price})]},n.id)})),l=function(){e(x(!a))};return Object(E.useEffect)((function(){u(Object.entries(t).reduce((function(e,t){var c=Object(I.a)(t,2),s=(c[0],c[1]);return e+s.stock*s.price}),0))}),[t]),Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"basket__wrapper ".concat(a?"visible":""),children:[Object(s.jsx)("div",{className:"basket__bg",onClick:l}),Object(s.jsxs)("div",{className:"basket",children:[Object(s.jsxs)("div",{className:"basket__header",onClick:l,children:[Object(s.jsx)("h1",{children:"Basket"}),Object(s.jsx)("button",{className:"basket__back"})]}),Object(s.jsx)(L.a,{className:"basket__items__wrapper",children:Object(s.jsx)("div",{className:"basket__items",children:j})}),Object(s.jsxs)("div",{className:"basket__resume",children:[Object(s.jsxs)("div",{className:"basket__total",children:[Object(s.jsx)("div",{className:"basket__total__text",children:"Total Amount"}),Object(s.jsx)("div",{className:"basket__total__price",children:d})]}),Object(s.jsx)("div",{className:"basket__actions",children:Object(s.jsx)("button",{disabled:0===d,onClick:function(){try{Object.entries(t).forEach(function(){var e=Object(K.a)(F.a.mark((function e(s){var n,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(I.a)(s,2),n[0],a=n[1],e.next=3,fetch("http://localhost:3000/grocery/"+a.id,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(i.a)(Object(i.a)({},a),{},{stock:c[a.id].stock-t[a.id].stock}))});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(s){}e(m()),alert("Purchase Completed!!!")},children:"Make a payment"})})]})]})]})})},H=function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("main",{className:"mimacom",children:[Object(s.jsx)(J,{}),Object(s.jsx)(D,{})]})})};c(32);t.default=function(){return B(),Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(n.a,{store:y,children:Object(s.jsx)(S,{children:Object(s.jsx)(H,{})})})})}}},[[17,1,2]]]);
//# sourceMappingURL=main.42a09dc3.chunk.js.map